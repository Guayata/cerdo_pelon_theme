<div class="content-page-width">
  <div class="container-fluid page-bienvenidos-tribu" id="step1">
    <div class="row justify-content-center">
      <div class="col-12 col-lg-9">
        <div class="row text-center ">
          <div class="col-12">
            <p class="title">¡HEY!</p>
            <p class="subtitle-index-section-welcome mb-2 d-none d-lg-block">
              <span>
                gracias por tu interés en formar parte 
              </span>
            </p>
            <p class="subtitle-index-section-welcome  mt-3 d-none d-lg-block">
              <span>
                de nuestra tribu.
              </span>
            </p>
            <p class="subtitle-index-section-welcome mb-0 d-block d-lg-none">
              <span>
                gracias por tu interés en formar parte  de nuestra tribu.
              </span>
            </p>
          </div>
        </div>
        <div class="row content-txt justify-content-center">
          <div class="col-12 col-lg-6 text-center">
            <p class="title text-uppercase">
              ¿Cómo funciona?
            </p>
            <p class="subtitle text-uppercase">
              <span>
                comisión para ti
              </span>
            </p>
            <p class="subtitle_small text-uppercase">
              y descuento para tus amigos
            </p>
            <p class="description text-center">
              Al registrar tus datos abajo, te generaremos un <strong>código único.</strong>
              Cada vez que nos recomiendes (en tus redes o reuniones) y
              alguien compre en nuestro sitio con tu código, le hacemos un
              <strong>10% de descuento </strong> en su compra y a ti te damos el <strong>10% de comisión.</strong>
              ¡Así de fácil!
            </p>
          </div>
        </div>
        <div class="row content-image-bottom justify-content-center">
          <div class="col-12 col-lg-8 text-center py-5">
            <img class="img-fluid lazyload"
                 data-src="{{ "imagen-como-funciona-bienvenido-tribu.jpg" | asset_url}}"
                 data-aspectratio="{{ preview_image.aspect_ratio }}"
                 alt="{{ preview_image.alt | escape }}">
          </div>
          <div class="col-12 text-end-paragraph text-center">
            <p>
              Adicionalmente, con cada venta que generes tendrás la posibilidad de ganar muchos premios.
            </p>
          </div>
        </div>
        <div class="row copy-hashtag py-4">
          <div class="col-12">
            <p class="text-center">
              #spreadgoodnews
            </p>
          </div>
        </div>
      </div>
      <div class="col-12 col-lg-12">
          <div class="row content-contact-form justify-content-center">
            <div class="col-12 line-top-box-container">
              <img class=" lazyload"
                   data-src="{{ "border-dashed-top.png" | asset_url}}"
                   data-aspectratio="{{ preview_image.aspect_ratio }}"
                   alt="{{ preview_image.alt | escape }}">
            </div>
            <div class="col-12  box-content-contact">
              <form action="" id="frmKuNew">
                <div class="row">
                  <div class="col-12 text-center">
                    <h1 class="title-contact-tribu text-uppercase">
                      ¡Bienvenidx a nuestra tribu!  <br>
                      para ser parte, solo llena la siguiente forma:
                    </h1>
                  </div>
                  <div class="col-12">
                    <div class="row">
                      <div class="col-6 col-lg content-input">
                        <input class="form-control" type="text" placeholder="Nombre" name="nombre" maxlength="64" required>
                      </div> 
                      <div class="col-6 col-lg-5 content-input">
                        <input class="form-control" type="text" placeholder="Apellido" name="apellidos" maxlength="64" required>
                      </div>
                      <div class="col-12 col-lg content-input">
                        <input class="form-control" type="text" placeholder="Celular" name="celular" minlength="10" maxlength="10" pattern="\d*" required>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-6 col-lg-5 content-input">
                        <input class="form-control" type="email" placeholder="E-mail" name="email" maxlength="128" required>
                      </div> 
                      <div class="col-6 col-lg-3 content-input">
                        <input class="form-control" type="text" placeholder="Código Postal" name="cp" minlength="5" maxlength="5" pattern="\d*" required>
                      </div>
                      <div class="col-12 col-lg-4 content-input">
						<input class="form-control" type="text" placeholder="Estado" name="estado" maxlength="128" required>
                      </div>
                    </div>
                    <div class="row"> 
                      <div class="col-6  col-lg-6 content-input">
                        <input class="form-control" type="text" placeholder="Municipio/Delegacion" name="municipio" maxlength="128" required>
                      </div> 
                      <div class="col-6  col-lg-6 content-input" id="divColonia">
                        <input class="form-control" type="text" placeholder="Colonia " id="ddColonia" maxlength="128" required>
                      </div>                      
                    </div>
                    <div class="row">
                      <div class="col-12 content-input">
                        <input class="form-control" type="text" placeholder="Calle y Nº" name="direccion" maxlength="128" required>
                      </div> 
                    </div>
                    <div class="row">
                      <div class="col-6 content-input">
                        <select class="form-control" id="ddEnteropor" required>
                          <option value="">¿Cómo te enteraste de nosotros?</option>
                          <option>Por medios digitales</option>
                          <option>Por medio de un amigo</option>
                        </select>
                      </div> 
                      <div class="col-6 content-input" id="divEnteroname"></div>                       
                    </div>                    
                    <div class="row">
                      <div class="col-12  content-input">
                        <div class="form-check checkbox">
                          <input class="form-check-input" type="checkbox" value="" name="optin1" id="flexCheckDefault">
                          <label class="form-check-label" for="flexCheckDefault">
                            <span>Al hacer clic en ENVIAR, acepto los <a href="/pages/terminos-condiciones">Términos y Condiciones</a></span>
                          </label>
                        </div>
                      </div> 
                    </div>
                    <div class="row">
                      <div class="col-12  content-button-submit text-center">
                        <button class="btn text-uppercase" type="submit">
                           Enviar
                        </button>
                      </div> 
                    </div>
                  </div>
                </div>
              </form>
            </div>
        </div>
      </div>
    </div>
  </div>
    
  <div class="container-fluid page-bienvenidos-tribu page-thankyou-tribu"  id="step2" style="display: none;">
    <div class="row justify-content-center">
      <div class="col-12 col-lg-9">
        <div class="row text-center ">
          <div class="col-12">
            <p class="title">¡BIENVENIDX!</p>
            <p class="subtitle">
              <span>
                ¡ya eres parte de nuestra tribu!
              </span>
            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="row justify-content-center">
      <div class="col-12">
        <div class="slider-people">
          <div>
            <img class="img-fluid w-100 lazyload"
                 data-src="{{"people-1.png" | asset_url }}">
          </div>
          <div>
            <img class="img-fluid w-100 lazyload"
                 data-src="{{"people-2.png" | asset_url }}">
          </div>
          <div>
            <img class="img-fluid w-100 lazyload"
                 data-src="{{"people-3.png" | asset_url }}">
          </div>
          <div>
            <img class="img-fluid w-100 lazyload"
                 data-src="{{"people-4.png" | asset_url }}">
          </div>
        </div>
      </div>
        <div class="col-12 col-lg-9 box-codigo-download text-center">
        <div class="row h-100">
          <div class="col-12 my-auto">
            <p class="title-codigo">
              Tu código ÚNICO es:  <span id="spcode"></span>
            </p>
            <p class="text-codigo">
              Es importante que siempre menciones tu código cuando nos recomiendes,
              ya que es la llave para que tus amigos obtengan un 10% de descuento 
              y podamos otorgarte el 10% de comisión por cada venta completada.
            </p>
          </div>
          </div>
      </div>
      <div class="col-12 col-lg-8 text-box-codigo-download text-center">
        En este link: <a href="https://foodnews/pages/perfil-tribu">foodnews/login</a> Encontrarás un espacio en donde
        podrás ver en tiempo real tus ventas y beneficios como parte de la tribu. 
        Para entrar a esta sección, hemos creado un usuario y password personal
      </div>
      <div class="col-12 col-lg-8 box-link-description text-center box-dates-container">
        <div class="box-dates-txt text-center text-uppercase">
          <div class="row h-100">
            <div class="col-12 my-auto">
              <p class="mb-0">
                Usuario: <span id="spuser"></span>
              </p>
              <p class="mb-0">
                Password: <span id="sppass"></span>
              </p>
            </div>
          </div>
        </div>
      </div>
      <div class="col-12 col-lg-10 box-iconos-section">
        <div class="row">
          <div class="col-12">
            <p class="title-section-icons text-center text-uppercase">
              <span>Para facilitar tu trabajo de embajadora </span><br>
               <span> hemos creado este paquete de Contenido food news:</span>
            </p>
          </div>
          <div class="col-12">
            <div class="row justify-content-center">
              <div class="col-6 col-lg content-iconos text-center">
                <div class="content-image">
                  <img class="img-fluid lazyload"
                       data-src="{{ "icono-1.png" | asset_url }}">
                  <p class="description-iconos">
                    Post Food News <br>
                    para Instagram
                  </p>
                </div>
              </div>
              <div class="col-6 col-lg content-iconos text-center">
                <div class="content-image">
                  <img class="img-fluid lazyload"
                       data-src="{{ "icono-2.png" | asset_url }}">
                  <p class="description-iconos">
                    Post Food News <br>
                    para Facebook
                  </p>
                </div>
              </div>
              <div class="col-6 col-lg content-iconos text-center">
                <div class="content-image">
                  <img class="img-fluid lazyload"
                       data-src="{{ "icono-3.png" | asset_url }}">
                  <p class="description-iconos">
                    Plantilla de email <br>
                    o mensaje de texto
                  </p>
                </div>
              </div>
              <div class="col-6 col-lg content-iconos text-center">
                <img class="img-fluid lazyload"
                     data-src="{{ "icono-4.png" | asset_url }}">
                <div class="content-image">
                  <p class="description-iconos">
                    Fotografías <br>
                    Food News
                  </p>
                </div>
              </div>
              <div class="col-6 col-lg content-iconos text-center">
                <div class="content-image">
                  <img class="img-fluid lazyload"
                       data-src="{{ "icono-5.png" | asset_url }}">
                  <p class="description-iconos">
                    Mensaje gráfico <br>
                    Whatsapp y Messenger
                  </p>
                </div>
              </div>
            </div>
          </div>
          <div class="col-12 text-center content-button-download">
            <p class="text-uppercase">
              Da click aquí para descargar un paquete de contenido para
              facilitarte la promoción de FOOD NEWS en redes y canales sociales.
            </p>
            <a class="btn text-uppercase" href="https://cdn.shopify.com/s/files/1/0600/9500/4835/files/FoodNews_PaqueteGrafico.zip?v=1644033004" target="_blank">
              Descargar
            </a>
          </div>
          <div class="col-12 text-final-box text-center text-uppercase">
            <p>
              ¡Gracias por ser parte de la tribu Food News!
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!--<div class="container-fluid page-bienvenidos-tribu page-thankyou-tribu"  id="step2" style="display: none;">
    <div class="row justify-content-center">
      <div class="col-12 col-lg-9">
        <div class="row text-center ">
          <div class="col-12">
            <p class="title">Gracias por tu interés,</p>
            <p class="subtitle">
              <span>
                ¡ahora eres parte de nuestra tribu!
              </span>
            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="row justify-content-center">
      <div class="col-12">
        <div class="slider-people">
          <div>
            <img class="img-fluid w-100 lazyload"
                 data-src="{{"people-1.png" | asset_url }}">
          </div>
          <div>
            <img class="img-fluid w-100 lazyload"
                 data-src="{{"people-2.png" | asset_url }}">
          </div>
          <div>
            <img class="img-fluid w-100 lazyload"
                 data-src="{{"people-3.png" | asset_url }}">
          </div>
          <div>
            <img class="img-fluid w-100 lazyload"
                 data-src="{{"people-4.png" | asset_url }}">
          </div>
        </div>
      </div>
      <div class="col-12 col-lg-10 box-iconos-section">
        <div class="row">
          <div class="col-12">
            <p class="title-section-icons text-center text-uppercase">
              Para facilitar tu trabajo de embajadora <br>
              hemos creado este paquete de Contenido food newS:
            </p>
          </div>
          <div class="col-12">
            <div class="row justify-content-center">
              <div class="col-6 col-lg content-iconos text-center">
                <div class="content-image">
                  <img class="img-fluid lazyload"
                       data-src="{{ "icono-1.png" | asset_url }}">
                  <p class="description-iconos">
                    Post Food News <br>
                    para Instagram
                  </p>
                </div>
              </div>
              <div class="col-6 col-lg content-iconos text-center">
                <div class="content-image">
                  <img class="img-fluid lazyload"
                       data-src="{{ "icono-2.png" | asset_url }}">
                  <p class="description-iconos">
                    Post Food News <br>
                    para Facebook
                  </p>
                </div>
              </div>
              <div class="col-6 col-lg content-iconos text-center">
                <div class="content-image">
                  <img class="img-fluid lazyload"
                       data-src="{{ "icono-3.png" | asset_url }}">
                  <p class="description-iconos">
                    Plantilla de email <br>
                    o mensaje de texto
                  </p>
                </div>
              </div>
              <div class="col-6 col-lg content-iconos text-center">
                <img class="img-fluid lazyload"
                     data-src="{{ "icono-4.png" | asset_url }}">
                <div class="content-image">
                  <p class="description-iconos">
                    Fotografías <br>
                    Food News
                  </p>
                </div>
              </div>
              <div class="col-6 col-lg content-iconos text-center">
                <div class="content-image">
                  <img class="img-fluid lazyload"
                       data-src="{{ "icono-5.png" | asset_url }}">
                  <p class="description-iconos">
                    Mensaje gráfico <br>
                    Whatsapp y Messenger
                  </p>
                </div>
              </div>
            </div>
          </div>
          <div class="col-12 text-center content-button-download">
            <a class="btn text-uppercase" href="https://cdn.shopify.com/s/files/1/0600/9500/4835/files/FoodNews_PaqueteGrafico.zip?v=1644033004" target="_blank">
              Descargar
            </a>
            <p>
              Da click aquí para descargar un paquete de contenido para
              facilitarte la promoción de FOOD NEWS en redes y canales sociales.
            </p>
          </div>
        </div>
      </div>
      <div class="col-12 col-lg-10 box-codigo-download text-center">
        <div class="row h-100">
          <div class="col-12 my-auto">
            <p class="title-codigo">
              Tu código es:  <span id="spcode"></span>
            </p>
            <p class="text-codigo">
              Es importante que siempre menciones tu código cuando nos recomiendes,
              ya que es la llave para que tus amigos obtengan un 10% de descuento y 
              podamos concentrar tu 10% de comisión por cada venta completada.
            </p>
          </div>
        </div>
      </div>
      <div class="col-12 col-lg-10 box-link-description text-center">
        <div class="title-link text-uppercase">
          <p class="mb-0">En este link:</p>
          <p><a href="/pages/perfil-tribu">foodnews/login</a></p>
        </div>
        <div class="text-link text-center">
          Encontrarás un espacio en donde podrás ver en tiempo real tus compras <br>
          y beneficios como parte de la tribu. Para entrar a esta sección, hemos creado un usuario y password personal
        </div>
        <div class="box-dates-txt text-center text-uppercase">
          <div class="row h-100">
            <div class="col-12 my-auto">
              <p class="mb-0">
                Usuario: <span id="spuser"></span>
              </p>
              <p>
                Password: <span id="sppass"></span>
              </p>
            </div>
          </div>
        </div>
        <div class="text-final-box text-center text-uppercase">
          <p>
            ¡Gracias por ser parte de la tribu Food News!
          </p>
        </div>
      </div>
    </div>
  </div>  -->
</div>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script>
  $('body').addClass('page-tribu')
</script>
<script src="https://cdn.jsdelivr.net/npm/js-cookie@rc/dist/js.cookie.min.js"></script>
<script>
  const api = "//gsjf60ub30.execute-api.us-east-1.amazonaws.com/production/";
  const tkn = Cookies.get('kuemtkn');
  if(tkn){
    window.location.replace("/pages/perfil-tribu");
  }
  
  $("#ddEnteropor").change(function() {
    if($(this).val() === 'Por medio de un amigo'){
      $('#divEnteroname').html(`<input class="form-control" type="text" placeholder="Nombre de tu amigo" name="enteroname" maxlength="128" required>`);
    }else{
      $('#divEnteroname').html(``);
    }
  });
  $("#frmKuNew input[name='cp']").change(function() {
  	const cp = $(this).val();
    $.get(`${api}postal?cp=${cp}`).done(function(r) {
      if(r.status){
        $("#frmKuNew input[name='estado']").val(r.data.estado);
        $("#frmKuNew input[name='municipio']").val(r.data.municipio);
        if(r.data.colonias.length === 1){
          $('#divColonia').html(`<input value="${(r.data.colonias[0]).colonia}" class="form-control" type="text" placeholder="Colonia " id="ddColonia" maxlength="128" required>`);
        }
        if(r.data.colonias.length > 1){
          let select = '<select class="form-control" id="ddColonia" required>';
          for(var c of r.data.colonias){
            select += `<option>${c.colonia}</option>`;
          }
          select += '</select>';
          $('#divColonia').html(select);
        }
      }else{
        alert( `ERROR: ${r.error}` );
      }
    });
  });
  
  $("#frmKuNew").submit(function(e) {
    e.preventDefault();
    const $f = $(this);
    const $b = $f.find("button[type='submit']");
    const email = $f.find("input[name='email']").val();
    const $enteroname = $f.find("input[name='enteroname']");
    const d = {
      email: email,
      nombre: $f.find("input[name='nombre']").val(),
      apellidos: $f.find("input[name='apellidos']").val(),
      celular: $f.find("input[name='celular']").val(),
      cp: $f.find("input[name='cp']").val(),
      estado: $f.find("input[name='estado']").val(),
      municipio: $f.find("input[name='municipio']").val(),
      colonia: $('#ddColonia').val(),
      direccion: $f.find("input[name='direccion']").val(),
      enteropor: $('#ddEnteropor').val(),
      optin1: $f.find("input[name='optin1']").prop('checked') ? '1' : '0',
      enteroname: $enteroname ? $enteroname.val() : null,
    };

    $b.prop('disabled', true);
    $.ajax({
      type: "POST",
      url: `${api}ambassadors/register`,
      data: JSON.stringify(d),
      contentType: "application/json",
      dataType: "json"
    }).done(function(r) {				  				
      console.log('response:', r);
      if(r.status){
        $('#step1').hide();
        $('#spcode').text(r.codigo);
        $('#spuser').text(email);
        $('#sppass').text(r.pass);
        $('#step2').show();
      }else{
        alert( `ERROR: ${r.error}` );
      }
    })
    .fail(function() {
      alert( "error" );
    })
    .always(function() {
      $b.prop('disabled', false);
    });
  });
</script>